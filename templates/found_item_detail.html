<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Found Item ‚Äî {{ item.item_name }}</title>
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@600;800&family=DM+Sans:wght@400;500&display=swap" rel="stylesheet">
    <style>
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        :root { --bg: #080c14; --surface: #0f1623; --border: rgba(255,255,255,0.06); --accent: #38bdf8; --accent2: #818cf8; --text: #e2e8f0; --muted: #64748b; --sidebar-w: 270px; }
        body { font-family: 'DM Sans', sans-serif; background: #f1f5f9; min-height: 100vh; }
        .sidebar { position: fixed; left: 0; top: 0; width: var(--sidebar-w); height: 100vh; background: var(--bg); display: flex; flex-direction: column; overflow: hidden; z-index: 10; }
        .sidebar::before { content: ''; position: absolute; top: -80px; left: -60px; width: 320px; height: 320px; background: radial-gradient(circle, rgba(56,189,248,0.12) 0%, transparent 70%); pointer-events: none; }
        .brand { display: flex; align-items: center; gap: 10px; padding: 22px 24px 18px; border-bottom: 1px solid var(--border); }
        .brand-icon { width: 34px; height: 34px; border-radius: 8px; background: linear-gradient(135deg, var(--accent), var(--accent2)); display: grid; place-items: center; font-size: 16px; flex-shrink: 0; }
        .brand-name { font-family: 'Syne', sans-serif; font-size: 15px; font-weight: 800; color: var(--text); }
        .brand-name span { color: var(--accent); }
        .profile-card { margin: 18px 16px; background: var(--surface); border: 1px solid var(--border); border-radius: 14px; padding: 18px 16px; display: flex; flex-direction: column; align-items: center; gap: 10px; }
        .avatar-wrap { position: relative; width: 70px; height: 70px; }
        .avatar-wrap img { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; border: 2px solid var(--accent); }
        .avatar-badge { position: absolute; bottom: 2px; right: 2px; width: 13px; height: 13px; border-radius: 50%; background: #22c55e; border: 2px solid var(--bg); }
        .profile-name { font-family: 'Syne', sans-serif; font-size: 15px; font-weight: 700; color: var(--text); }
        .profile-dept { font-size: 12px; color: var(--muted); background: rgba(255,255,255,0.05); padding: 3px 10px; border-radius: 20px; }
        nav { flex: 1; padding: 6px 12px; overflow-y: auto; }
        nav::-webkit-scrollbar { width: 0; }
        .nav-label { font-size: 10px; font-weight: 600; letter-spacing: 0.1em; color: var(--muted); padding: 14px 10px 6px; text-transform: uppercase; }
        .nav-item { display: flex; align-items: center; gap: 12px; padding: 11px 14px; border-radius: 10px; color: #94a3b8; text-decoration: none; font-size: 14px; font-weight: 500; transition: background 0.2s, color 0.2s; position: relative; }
        .nav-item:hover { background: rgba(255,255,255,0.05); color: var(--text); }
        .nav-item.active { background: rgba(56,189,248,0.1); color: var(--accent); }
        .nav-item.active::before { content: ''; position: absolute; left: 0; top: 20%; height: 60%; width: 3px; border-radius: 2px; background: var(--accent); }
        .nav-icon { font-size: 16px; width: 20px; text-align: center; }
        .edit-cta { margin: 14px 16px 20px; display: flex; align-items: center; justify-content: center; gap: 8px; padding: 12px; background: linear-gradient(135deg, #5c6ef8, #a78bfa); border-radius: 12px; color: white; font-weight: 600; font-size: 13px; text-decoration: none; box-shadow: 0 4px 20px rgba(92,110,248,0.35); transition: transform 0.2s; }
        .edit-cta:hover { transform: translateY(-2px); color: white; }
        .logout { margin: 0 12px 16px; display: flex; align-items: center; gap: 12px; padding: 11px 14px; border-radius: 10px; color: #f87171; font-size: 14px; font-weight: 500; text-decoration: none; transition: background 0.2s; }
        .logout:hover { background: rgba(248,113,113,0.1); }
        .main { margin-left: var(--sidebar-w); padding: 36px; }
        .back-link { display: inline-flex; align-items: center; gap: 6px; color: #64748b; text-decoration: none; font-size: 13px; font-weight: 500; margin-bottom: 22px; transition: color 0.2s; }
        .back-link:hover { color: #0ea5e9; }
        .flash { padding: 14px 18px; border-radius: 12px; margin-bottom: 20px; font-size: 14px; font-weight: 500; max-width: 1080px; }
        .flash.success { background: #dcfce7; color: #15803d; border: 1px solid #bbf7d0; }
        .flash.error   { background: #fee2e2; color: #dc2626; border: 1px solid #fecaca; }
        .page-layout { display: grid; grid-template-columns: 1fr 320px; gap: 24px; align-items: start; max-width: 1080px; }
        .detail-card { background: white; border-radius: 20px; box-shadow: 0 6px 28px rgba(0,0,0,0.07); overflow: hidden; }
        .detail-img { width: 100%; height: 300px; object-fit: cover; display: block; }
        .detail-img-placeholder { width: 100%; height: 300px; background: linear-gradient(135deg, #e0f2fe, #bae6fd); display: flex; align-items: center; justify-content: center; flex-direction: column; gap: 10px; }
        .detail-img-placeholder .icon { font-size: 64px; }
        .detail-img-placeholder span { color: #64748b; font-size: 14px; }
        .detail-header { padding: 20px 24px 0; }
        .detail-title { font-family: 'Syne', sans-serif; font-size: 22px; font-weight: 800; color: #0f172a; }
        .detail-badges { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 8px; }
        .badge { font-size: 12px; font-weight: 600; padding: 4px 12px; border-radius: 20px; }
        .badge-cat { background: #e0f2fe; color: #0369a1; }
        .badge-available { background: #dcfce7; color: #15803d; }
        .badge-claimed   { background: #fef9c3; color: #a16207; }
        .badge-closed    { background: #fee2e2; color: #dc2626; }
        .detail-body { padding: 20px 24px 24px; display: flex; flex-direction: column; gap: 20px; }
        .section-title { font-family: 'Syne', sans-serif; font-size: 11px; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase; color: #94a3b8; margin-bottom: 10px; }
        .desc-text { font-size: 14px; color: #374151; line-height: 1.7; }
        .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }
        .info-row { display: flex; gap: 10px; align-items: flex-start; }
        .info-icon { font-size: 16px; flex-shrink: 0; width: 22px; text-align: center; margin-top: 1px; }
        .info-label { font-size: 11px; font-weight: 600; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.06em; }
        .info-value { font-size: 14px; color: #1e293b; font-weight: 500; }
        .divider { border: none; border-top: 1px solid #f1f5f9; }

        /* CLAIM SECTION */
        .claim-section { background: linear-gradient(135deg, #f0f9ff, #e0f2fe); border: 2px solid #bae6fd; border-radius: 16px; padding: 24px; }
        .claim-section-title { font-family: 'Syne', sans-serif; font-size: 16px; font-weight: 800; color: #0369a1; display: flex; align-items: center; gap: 8px; margin-bottom: 8px; }
        .claim-section p { font-size: 13px; color: #475569; margin-bottom: 16px; line-height: 1.6; }
        .claim-section textarea { width: 100%; padding: 12px 14px; border: 1.5px solid #bae6fd; border-radius: 10px; font-family: 'DM Sans', sans-serif; font-size: 13px; color: #1e293b; background: white; resize: vertical; min-height: 80px; outline: none; transition: border-color 0.2s; margin-bottom: 12px; }
        .claim-section textarea:focus { border-color: #0ea5e9; box-shadow: 0 0 0 3px rgba(14,165,233,0.12); }
        .claim-section textarea::placeholder { color: #94a3b8; }
        .btn-claim { display: flex; align-items: center; justify-content: center; gap: 8px; width: 100%; padding: 14px; background: linear-gradient(135deg, #0ea5e9, #0284c7); color: white; border: none; border-radius: 12px; font-family: 'DM Sans', sans-serif; font-size: 15px; font-weight: 700; cursor: pointer; box-shadow: 0 4px 16px rgba(14,165,233,0.35); transition: transform 0.18s, box-shadow 0.18s; }
        .btn-claim:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(14,165,233,0.5); }
        .notice-box { border-radius: 16px; padding: 20px 24px; text-align: center; }
        .notice-box .icon { font-size: 36px; margin-bottom: 8px; }
        .notice-box p { font-size: 14px; font-weight: 600; }
        .notice-box small { font-size: 12px; opacity: 0.8; }
        .notice-claimed { background: #fef9c3; border: 2px solid #fde68a; color: #a16207; }
        .notice-owner   { background: #f0fdf4; border: 2px solid #bbf7d0; color: #15803d; }

        /* CONTACT CARD */
        .contact-card { background: white; border-radius: 20px; box-shadow: 0 6px 28px rgba(0,0,0,0.08); overflow: hidden; position: sticky; top: 24px; }
        .contact-header { background: linear-gradient(135deg, #f97316, #fbbf24); padding: 30px 24px 54px; position: relative; text-align: center; }
        .contact-header::after { content: ''; position: absolute; bottom: -1px; left: 0; right: 0; height: 32px; background: white; border-radius: 50% 50% 0 0 / 32px 32px 0 0; }
        .contact-avatar-outer { position: absolute; bottom: -36px; left: 50%; transform: translateX(-50%); z-index: 2; }
        .contact-avatar { width: 90px; height: 90px; border-radius: 50%; object-fit: cover; border: 4px solid white; box-shadow: 0 4px 20px rgba(0,0,0,0.15); display: block; }
        .contact-body { padding: 48px 24px 24px; text-align: center; }
        .contact-name { font-family: 'Syne', sans-serif; font-size: 17px; font-weight: 800; color: #0f172a; text-transform: uppercase; margin-bottom: 4px; }
        .contact-dept { font-size: 13px; color: #64748b; margin-bottom: 12px; }
        .contact-tags { display: flex; justify-content: center; gap: 8px; margin-bottom: 22px; flex-wrap: wrap; }
        .contact-tag { background: #f1f5f9; color: #475569; font-size: 12px; font-weight: 600; padding: 4px 14px; border-radius: 20px; }
        .contact-info-list { display: flex; flex-direction: column; gap: 10px; margin-bottom: 18px; text-align: left; }
        .contact-info-row { display: flex; align-items: center; gap: 12px; background: #f8fafc; border-radius: 12px; padding: 12px 14px; }
        .contact-info-icon { width: 36px; height: 36px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 17px; flex-shrink: 0; }
        .icon-mobile { background: #fee2e2; } .icon-email { background: #e0f2fe; }
        .contact-info-label { font-size: 10px; font-weight: 700; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 3px; }
        .contact-info-value { font-size: 13px; font-weight: 600; color: #0f172a; }
        .btn-whatsapp { display: flex; align-items: center; justify-content: center; gap: 10px; width: 100%; padding: 14px; background: #25d366; color: white; border-radius: 14px; text-decoration: none; font-size: 15px; font-weight: 700; box-shadow: 0 4px 16px rgba(37,211,102,0.35); transition: transform 0.18s; margin-bottom: 10px; }
        .btn-whatsapp:hover { transform: translateY(-2px); }
        .btn-whatsapp svg { width: 22px; height: 22px; fill: white; flex-shrink: 0; }
        .btn-email { display: flex; align-items: center; justify-content: center; gap: 8px; width: 100%; padding: 13px; background: white; color: #374151; border: 1.5px solid #e5e7eb; border-radius: 14px; text-decoration: none; font-size: 14px; font-weight: 600; transition: border-color 0.2s; margin-bottom: 16px; }
        .btn-email:hover { border-color: #0ea5e9; background: #f0f9ff; color: #0ea5e9; }
        .contact-note { font-size: 11px; color: #94a3b8; text-align: center; }
        .btn-delete { display: flex; align-items: center; justify-content: center; gap: 7px; width: 100%; padding: 12px; border-radius: 12px; border: 2px solid #fecaca; background: #fff1f2; color: #dc2626; font-family: 'DM Sans', sans-serif; font-size: 14px; font-weight: 700; cursor: pointer; margin-top: 10px; transition: background 0.18s, border-color 0.18s; }
        .btn-delete:hover { background: #fee2e2; border-color: #f87171; }
        @media (max-width: 900px) { .sidebar { display: none; } .main { margin-left: 0; padding: 20px 16px; } .page-layout { grid-template-columns: 1fr; } .contact-card { position: static; } }
    </style>
</head>
<body>
<div class="sidebar">
    <div class="brand"><div class="brand-icon">üîç</div><div class="brand-name">Lost<span>&</span>Found</div></div>
    <div class="profile-card">
        <a href="{{ url_for('profile', user_id=user.id) }}" class="avatar-wrap">
            <img src="{{ url_for('static', filename='uploads/' + user.profile_pic) }}" alt=""><span class="avatar-badge"></span>
        </a>
        <div class="profile-name">{{ user.name }}</div>
        <div class="profile-dept">{{ user.department }}</div>
    </div>
    <nav>
        <div class="nav-label">Menu</div>
        <a href="{{ url_for('profile', user_id=user.id) }}" class="nav-item"><span class="nav-icon">üë§</span> My Profile</a>
        <a href="{{ url_for('report_lost', user_id=user.id) }}" class="nav-item"><span class="nav-icon">üì¶</span> Report Lost Item</a>
        <a href="{{ url_for('report_found', user_id=user.id) }}" class="nav-item"><span class="nav-icon">‚úÖ</span> Report Found Item</a>
        <a href="{{ url_for('lost_items_list', user_id=user.id) }}" class="nav-item"><span class="nav-icon">üîé</span> Browse Lost Items</a>
        <a href="{{ url_for('found_items_list', user_id=user.id) }}" class="nav-item active"><span class="nav-icon">üìã</span> Browse Found Items</a>
        <a href="{{ url_for('my_claims', user_id=user.id) }}" class="nav-item"><span class="nav-icon">ü§ù</span> My Claims</a>
        <div class="nav-label">Account</div>
        <a href="#" class="nav-item"><span class="nav-icon">‚öôÔ∏è</span> Settings</a>
    </nav>
    <a href="{{ url_for('edit_profile', user_id=user.id) }}" class="edit-cta">‚úèÔ∏è Edit Profile</a>
    <a href="/logout" class="logout"><span class="nav-icon">üö™</span> Logout</a>
</div>

<div class="main">
    <a href="{{ url_for('found_items_list', user_id=user.id) }}" class="back-link">‚Üê Back to Found Items</a>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% for category, message in messages %}
            <div class="flash {{ category }}">{{ message }}</div>
        {% endfor %}
    {% endwith %}

    <div class="page-layout">
        <div style="display:flex;flex-direction:column;gap:20px;">
            <div class="detail-card">
                {% if item.image %}
                    <img class="detail-img" src="{{ url_for('static', filename='uploads/found_items/' + item.image) }}" alt="{{ item.item_name }}">
                {% else %}
                    <div class="detail-img-placeholder"><span class="icon">üì¶</span><span>No photo uploaded</span></div>
                {% endif %}
                <div class="detail-header">
                    <div class="detail-title">{{ item.item_name }}</div>
                    <div class="detail-badges">
                        <span class="badge badge-cat">{{ item.category }}</span>
                        <span class="badge {% if item.status == 'Available' %}badge-available{% elif item.status == 'Claimed' %}badge-claimed{% else %}badge-closed{% endif %}">{{ item.status }}</span>
                    </div>
                </div>
                <div class="detail-body">
                    <div>
                        <div class="section-title">Description</div>
                        <div class="desc-text">{{ item.description }}</div>
                    </div>
                    <hr class="divider">
                    <div>
                        <div class="section-title">Item Details</div>
                        <div class="info-grid">
                            <div class="info-row"><span class="info-icon">üè∑Ô∏è</span><div><div class="info-label">Category</div><div class="info-value">{{ item.category }}</div></div></div>
                            <div class="info-row"><span class="info-icon">üìç</span><div><div class="info-label">Where Found</div><div class="info-value">{{ item.location_found }}</div></div></div>
                            <div class="info-row"><span class="info-icon">üìÖ</span><div><div class="info-label">Date Found</div><div class="info-value">{{ item.date_found.strftime('%d %B %Y') }}</div></div></div>
                            <div class="info-row"><span class="info-icon">‚úÖ</span><div><div class="info-label">Status</div><div class="info-value">{{ item.status }}</div></div></div>
                            <div class="info-row"><span class="info-icon">üïí</span><div><div class="info-label">Reported On</div><div class="info-value">{{ item.created_at.strftime('%d %b %Y, %I:%M %p') }}</div></div></div>
                            <div class="info-row"><span class="info-icon">üìå</span><div><div class="info-label">Item ID</div><div class="info-value">#{{ item.id }}</div></div></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CLAIM SECTION -->
            {% if item.status == 'Available' and item.user_id != user.id and not already_claimed %}
            <div class="claim-section">
                <div class="claim-section-title">üôã Is this your item?</div>
                <p>If this belongs to you, submit a claim request. The finder will review and approve or reject it.</p>
                <form action="{{ url_for('submit_claim', item_id=item.id, user_id=user.id) }}" method="POST">
                    <textarea name="message" placeholder="Describe how you know this is yours ‚Äî colour, brand, what was inside, where you lost it‚Ä¶ The more detail, the better!"></textarea>
                    <button type="submit" class="btn-claim">ü§ù Submit Claim Request</button>
                </form>
            </div>
            {% elif already_claimed %}
            <div class="notice-box" style="background:#fff4e5;border:2px solid #fbbf24;color:#92400e;border-radius:16px;padding:20px 24px;text-align:center;">
                <div style="font-size:36px;margin-bottom:8px;">‚è≥</div>
                <p style="font-weight:700;">You already submitted a claim for this item</p>
                <small>Check <a href="{{ url_for('my_claims', user_id=user.id) }}" style="color:#f97316;font-weight:700;">My Claims</a> to track your request status.</small>
            </div>
            {% elif item.status == 'Claimed' %}
            <div class="notice-box notice-claimed">
                <div class="icon">üîí</div>
                <p>This item has already been claimed</p>
                <small>Contact the finder directly if you believe this is yours.</small>
            </div>
            {% elif item.user_id == user.id %}
            <div class="notice-box notice-owner">
                <div class="icon">‚úÖ</div>
                <p>You reported this item</p>
                <small>Manage incoming claim requests from the Admin panel.</small>
            </div>
            {% endif %}
        </div>

        <!-- CONTACT CARD -->
        <div class="contact-card">
            <div class="contact-header">
                <div class="contact-avatar-outer">
                    <img class="contact-avatar" src="{{ url_for('static', filename='uploads/' + item.profile_pic) }}" alt="{{ item.reporter_name }}">
                </div>
            </div>
            <div class="contact-body">
                <div class="contact-name">{{ item.reporter_name }}</div>
                <div class="contact-dept">{{ item.department }}</div>
                <div class="contact-tags">
                    {% if item.year %}<span class="contact-tag">{{ item.year }}</span>{% endif %}
                    {% if item.section %}<span class="contact-tag">Section {{ item.section }}</span>{% endif %}
                </div>
                <div class="contact-info-list">
                    <div class="contact-info-row">
                        <div class="contact-info-icon icon-mobile">üì±</div>
                        <div><div class="contact-info-label">Mobile</div><div class="contact-info-value">{{ item.reporter_mobile }}</div></div>
                    </div>
                    <div class="contact-info-row">
                        <div class="contact-info-icon icon-email">‚úâÔ∏è</div>
                        <div><div class="contact-info-label">Email</div><div class="contact-info-value">{{ item.reporter_email }}</div></div>
                    </div>
                </div>
                <a href="https://wa.me/91{{ item.reporter_mobile }}" target="_blank" class="btn-whatsapp">
                    <svg viewBox="0 0 32 32"><path d="M16 0C7.163 0 0 7.163 0 16c0 2.822.736 5.472 2.027 7.774L0 32l8.417-2.008A15.93 15.93 0 0016 32c8.837 0 16-7.163 16-16S24.837 0 16 0zm0 29.333a13.27 13.27 0 01-6.773-1.854l-.486-.288-5.013 1.196 1.22-4.875-.317-.5A13.267 13.267 0 012.667 16C2.667 8.636 8.636 2.667 16 2.667S29.333 8.636 29.333 16 23.364 29.333 16 29.333zm7.27-9.873c-.398-.199-2.354-1.162-2.72-1.294-.366-.133-.633-.199-.9.199-.266.398-1.032 1.294-1.265 1.56-.233.266-.466.3-.864.1-.398-.2-1.681-.62-3.202-1.977-1.183-1.056-1.982-2.36-2.214-2.758-.232-.398-.025-.614.175-.812.18-.179.398-.466.597-.699.2-.233.266-.399.399-.665.133-.266.067-.499-.033-.698-.1-.2-.9-2.168-1.232-2.967-.325-.779-.655-.673-.9-.686l-.765-.013c-.266 0-.698.1-1.064.499s-1.398 1.366-1.398 3.33 1.431 3.862 1.63 4.128c.2.266 2.816 4.299 6.822 6.03.954.412 1.698.658 2.278.843.957.305 1.829.262 2.518.159.768-.114 2.354-.962 2.687-1.892.333-.93.333-1.727.233-1.893-.1-.165-.366-.265-.764-.464z"/></svg>
                    Chat on WhatsApp
                </a>
                <a href="mailto:{{ item.reporter_email }}" class="btn-email">‚úâ Send Email</a>
                <div class="contact-note">üîí Contact info visible to campus members only</div>

                {% if user.id == item.user_id or user.role == 'Admin' %}
                <form action="{{ url_for('delete_found_item', item_id=item.id, user_id=user.id) }}" method="POST"
                      onsubmit="return confirm('Delete this found item? All claim requests will also be removed. This cannot be undone.')">
                    <button type="submit" class="btn-delete">
                        üóë {% if user.role == 'Admin' %}Admin Delete{% else %}Delete My Report{% endif %}
                    </button>
                </form>
                {% endif %}
            </div>
        </div>
    </div>
</div>
<div style="text-align:center; padding:15px; background:#1a1a2e; color:#fff; font-size:14px; margin-top:20px;">
Developed by <b>Patan Jamsheer</b> | CSE (AI-ML)
</div>
<div style="text-align:center; padding:15px; background:#1a1a2e; color:#fff; font-size:14px; margin-top:20px;">
Developed by <b>Patan Jamsheer</b> | CSE (AI-ML)
</div>
<div style="text-align:center; padding:15px; background:#1a1a2e; color:#fff; font-size:14px; margin-top:20px;">Developed by <b>Patan Jamsheer</b> | CSE (AI-ML)</div>
</body>
</html>